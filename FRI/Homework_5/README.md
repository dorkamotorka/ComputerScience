# Homework 5

## Part one

Let us recall the following properties of the Legendre symbols (lectures).
For odd primes $p$ and $q$, we have

- $\left ({-1 \over p}\right) = (-1)^{(p-1)/2}$
- $\left ({2 \over p}\right)  = (-1)^{(p^2-1)/8}$

Let $n \ge 3$ be an odd positive integer.

- Show that for odd positive integers $n_1$ and $n_2$, we have
  $$
  {n_1n_2-1 \over 2} \equiv {n_1-1 \over 2} + {n_2-1 \over 2} \pmod{2}.
  $$
  From this deduce $\left ({-1 \over n}\right) = (-1)^{(n-1)/2}$.

  		Če imamo:

			$\left ({n1*n2-1 \over 2}\right) \equiv ({n1-1 \over 2} + {n2-1 \over 2}) (mod 2)	
		
   		prestavimo desno stran enačbe na levo in opazimo da lahko razčlenimo na dvočlenik:

			$\left ({n1*n2-n1-n2+1 \over 2}\right) \equiv 0 (mod 2)

			$\left ({(n1-1)*(n2-1) \over 2}\right) \equiv 0 (mod 2)	

   		Ker sta n1 in n2 liha, sta vrednost v oklepaju (n1-1),(n2-1) sodi oz:

			n1 - 1 = 2a, n2 - 1 = 2b

		, kjer sta a in b celi števili. Torej zgornjo enačbo lahko napišemo kot:

			$\left ({4*a*b \over 2}\right) \equiv 0 (mod 2)	

			$\left ({2*a*b}\right) \equiv 0 (mod 2)	

   		Iz tega pa sledi enakost:

			0 \equiv 0 (mod 2)

   		Iz te izpeljave lahko zdaj sledeči izraz razpišemo kot:

			$\left (-1)^({n-1 \ over 2}\right) = (-1)^({n1*n2-1 \over 2}) = (-1)^(({n1-1) \ over 2} + {n2-1 \over 2}) = (-1)^({n1-1) \ over 2})*(-1)^({n2-1) \ over 2})

   		Z popolno indukcijo lahko dokažemo da velja:

			$\left (-1)^({n-1 \ over 2}\right) = ({-1 \over n1})*({-1 \over n2})

   		Če združimo izraz na desni strani, dobimo:

			({-1 \over n1})*({-1 \over n2}) = ({-1 \over n}) 

   		saj je:

			n1 * n2 = n

   		Torej smo dokazali enakost.


- Show that for odd positive integers $n_1$ and $n_2$, we have
  $$
  {n_1^2n_2^2-1 \over 8} \equiv
  {n_1^2-1 \over 8} + {n_2^2-1 \over 8} \pmod{2}.
  $$
  From this deduce $\left ({2 \over n}\right) = (-1)^{(n^2-1)/8}$.

  		Dokaz je podoben zgornji nalogi. Če imamo:

			$\left ({n1^2*n2^2-1 \over 8}\right) \equiv ({n1^2-1 \over 8} + {n2^2-1 \over 8}) (mod 8)	

   		prestavimo desno stran enačbe na levo in opazimo da lahko razčlenimo na dvočlenik:

			$\left ({n1^2*n2^2-n1^2-n2^2+1 \over 8}\right) \equiv (0) (mod 8)	

			$\left ({(n1^2-1)*(n2^2-1) \over 8}\right) \equiv (0) (mod 8)	

   		n1^2 in n2^2 sta liha, saj ja liho število na kvadrat ravno tako liho število.
		Dokaz:

			Če je x liho število, velja:

				x = 2k + 1, k je celo število

			Če kvadriramo in razstavimo, dobimo:

				x^2 = (2*k+1)(2*k+1) = 4*k^2 + 4*k + 1 = 2(2*k^2 + 2*k) + 1

			Ker je k celo število je tudi 2*k^2 + 2*k celo število. Označimo:

				l = 2*k^2 + 2*k

			in zapišemo:

				x^2 = 2l + 1

			Torej vidimo da je tudi x^2 liho število.

   		Ker sta n1^2 in n2^2 liha, sta vrednost v oklepaju (n1-1),(n2-1) sodi oz:

			n1^2 - 1 = 2a, n2^2 - 1 = 2b

		, kjer sta a in b celi števili. Torej zgornjo enačbo lahko napišemo kot:

			$\left ({4*a*b \over 8}\right) \equiv (0) (mod 8)	

			$\left ({a*b \over 2}\right) \equiv (0) (mod 8)	

   		Iz tega pa sledi enakost:

			$\left ({0}\right) \equiv (0) (mod 8)	

   		za a in b celi števili.

   		Iz te izpeljave lahko zdaj sledeči izraz razpišemo kot:

			$\left (-1)^({n^2-1 \ over 8}\right) = (-1)^({n1^2*n2^2-1 \over 8}) = (-1)^(({n1^2-1) \ over 8} + {n2^2-1 \over 8}) = (-1)^({n1^2-1) \ over 8})*(-1)^({n2^2-1) \ over 8})

   		Z popolno indukcijo lahko dokažemo da velja:

			$\left (-1)^({n^2-1 \ over 8}\right) = ({-1 \over n1^2})*({-1 \over n2^2})

   		Če združimo izraz na desni strani, dobimo:

			({-1 \over n1^2})*({-1 \over n2^2}) = ({-1 \over n^2}) 

   		saj je:

			n1^2 * n2^2 = n^2

   		Torej smo dokazali enakost.


## Part two

Bob "lost" his decryption exponent $d_B$ of his private key $\text{sk}_B=(d_B, n_B)$. Instead of generating a completely new private key he decided to just change the encryption exponent $e_B'$ (and also decryption exponent) leaving public modulus unchanged. His new private/public key pair is $(\text{sk}_B', \text{pk}_B') = ((d_B', n_B), (e_B', n_B))$.
Bob sends his new public key $\text{pk}_B'$ to Alice.

After some time Alice encrypts a message $m$ with Bob's new public key $\text{pk}_B'=(e_B', n_B)$ and sends it to him.

```python
pk_B = (65537, 780599032234975811341337402481579339244977106697680155571408017289870397205474776594988173210469010471827203018207637265087668980028487213856285651896772514731620740107589603250018809532353908373872228771684107393408147099970033612639652934093290907032137862997409242695063173841099249214963729400228614747992865961146305013317935155315445227982083961476155839486413393102590554948392790512152545354984257303165185669326483612073132709888662498694628541864867772741811208466574056212763450133080290973747413164823944228518615519941589766063081422312226857098722756760798744759058791598893374251700451609573179019029082894344279524586752645011966074177024535274526614379267379433782524169494125317219632631637188905368328335031243387312503457725322953887025464075430657951920747630820986382480473583165619039074222435987761159127086311386057454058779600071246400893931512876334384899593033965168431831238196085471849502811342141737895537321966546315440976695029427146448566122312540287339779585972909472892538360714867460843638162522290036020862914693463850334348851012645012730899991913026747261003205222640201129363570608744229268411219742543719124560460047131199019293090540559264494563002679383036489321446344179990875967457743091)

pk_B' = (170141183460469231731687303715884105727, 780599032234975811341337402481579339244977106697680155571408017289870397205474776594988173210469010471827203018207637265087668980028487213856285651896772514731620740107589603250018809532353908373872228771684107393408147099970033612639652934093290907032137862997409242695063173841099249214963729400228614747992865961146305013317935155315445227982083961476155839486413393102590554948392790512152545354984257303165185669326483612073132709888662498694628541864867772741811208466574056212763450133080290973747413164823944228518615519941589766063081422312226857098722756760798744759058791598893374251700451609573179019029082894344279524586752645011966074177024535274526614379267379433782524169494125317219632631637188905368328335031243387312503457725322953887025464075430657951920747630820986382480473583165619039074222435987761159127086311386057454058779600071246400893931512876334384899593033965168431831238196085471849502811342141737895537321966546315440976695029427146448566122312540287339779585972909472892538360714867460843638162522290036020862914693463850334348851012645012730899991913026747261003205222640201129363570608744229268411219742543719124560460047131199019293090540559264494563002679383036489321446344179990875967457743091)
```

Before encryption, Alice used the following encoding:

```python
m = '<messge>'

# encodeing
x = int.from_bytes(m.encode("utf-8"), byteorder='big')

# decodeing (maximum length of message is 4096 bits -- size of modulus)
m = x.to_bytes(512, byteorder='big').decode("utf-8")
```

Eve eavesdropped on Alice's encrypted message $E(\text{pk}_B',\text{encode}(m))$ and Bob's public key $\text{pk}_B$. She was also able to retrieve Bob's old decryption exponent $d_B$.

```python
E(pk_B', m) = 445061244155219428157131172099304361377805667414526798888885084065481998205815529700778968890261085415437882026827116995379602419649828454703826777001246109690726808868189748057242590648659156121225555716662471228053135809765149944621219876393217018562886420844434301881032779370626217033933066420251276419071600625442643401329741214059980366834974611457649249968061104982450955085850385710394781164833809714087772096781371581489487007899560717358756300920352261547415267146520151438081849604420212703715926429715741191550964834989318432768916367986816769133481896286684638634854247907808237894608412234066690186853714071724505400093242467970940552732687051818808339637260468388081911145026316729740942798573632537559839103219840631755729882267417703679227757727479622077506801176110201794052233795268990507542952960103670064468661345060768237398513670032701453729818959598427014575333283013103612503927111915041804743438858347711032781395464031226585933141266506033086292669318855505927583991495477590564088994130556095332252314476298757568214187003827978562864442399389785286899164432219434068712310643694427411629491183103738295582566821563270507492333590421518723340713584777510204725968631511118171962157546615286383067601841461

d_B = 105029559885988322694171433161154258105531350639488283135155345781193480973463487495836027150615922827419202530090711283756398142513255111643571217456181089077977809272147414765074169743141992523930074817411698109389704153799163165788126700533052157074772901962420536522652350076000017998650383231628178354941500099873172675090979938043724858024413939794264952509135195391590147756762250739828816469173919784233495692999693798789399640444302087576319246870689900667367917912907976069764378950417352118749785453826350614264875591724444795415479072614694240290164903323568721962942771630056941485748425809744362613329843590754878274346640926125748471967120198347754904047092684375956652112108437817881436792850772795830895129567108953623775791745878724092979572133501662892227234057540580549783103153889321807190173711919876390361792092555787148232748935548415422123618737666119962003222163352512915445591267089355941908223428896479285162406179958522030280356601418321078839478431203797712265576062042883474641311527804677143666266815006412917352601027541224578151267344432181185670578617102293510749691968507289637411166513708605158482212932799716245456753989634922099224651355964561044476620515960197314571001093213218399806150727473
```

**Help Eve to decrypt Alice's message.**

I appended the solution (python script) beside the .md file.
