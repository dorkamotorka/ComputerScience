#!/usr/bin/env python
import gmpy2

n = "1869578692404843692322851853790504675785490458941418816789937357228584999694229481781082576516004784967793396134042249283731541326522693989189672781989605367915467207173921917764601173241003275079144891798109323179882563958434067801607159395991293988128979523500485675739199386415393849926760028894957048405194696264543096632626266113459760373772648042130342168769029700837387351405620281318401168210834520710877989913969345751805302638927721067161987258238119709324242788800684044845924947196434207131958051848544612331436580528999574831395608419325858276755014492392928240007721159544167457326123991416480753423984310450347787167210183775589168689021239431549646289225543921262925762854468723108863565081485561010957193372906716767453636146225697688527085520729322590370367846553675015245648558243086523704781262012616424483189936559549788076211532572418932359209054902532723352725511759965792485553995457211293158370352311"

nn = gmpy2.mpz(int(n))
print("nn = ", nn)
gmpy2.get_context().precision=925

# Assume k is small such that k^2 ~ n (= p*q)
k = gmpy2.add(gmpy2.isqrt(nn), 1)

h = gmpy2.sub(gmpy2.mul(k, k), nn)
sh = gmpy2.isqrt(h)

p = gmpy2.add(k, sh) # p = k + sh
q = gmpy2.sub(k, sh) # p = k - sh

assert nn == gmpy2.mul(p, q)

print("p = ", p)
print("q = ", q)
print("difference =", p - q)
